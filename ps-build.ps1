if (Test-Path .\build) { Remove-Item -Recurse -Force .\build }; New-Item -ItemType Directory -Path .\build\ViewshedAnalysis | Out-Null; $files = @('__init__.py','metadata.txt','visibility_plugin.py','visibility_provider.py','icon.png','logo2.png','plugin_upload.py'); foreach ($f in $files) { Copy-Item $f .\build\ViewshedAnalysis\ }; Copy-Item -Recurse .\algorithms .\build\ViewshedAnalysis\algorithms; Copy-Item -Recurse .\i18n .\build\ViewshedAnalysis\i18n; Get-ChildItem -Recurse .\build\ViewshedAnalysis -Include __pycache__ -Directory | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue; Compress-Archive -Path .\build\ViewshedAnalysis -DestinationPath .\build\ViewshedAnalysis.zip -Force; Write-Host "Done: build\ViewshedAnalysis.zip"